<!DOCTYPE html>
<html>
<head>
  <title>Voice Input Test</title>
  <meta charset="UTF-8">
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      max-width: 600px;
      margin: 2rem auto;
      padding: 1rem;
    }
    h1 {
      color: #333;
    }
    .test-container {
      border: 1px solid #ddd;
      padding: 2rem;
      border-radius: 8px;
      background: #f9fafb;
    }
    #transcription-output {
      margin-top: 1rem;
      padding: 1rem;
      background: white;
      border-radius: 4px;
      border: 1px solid #e5e7eb;
    }
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <h1>ct-voice-input Component Test</h1>

  <div class="test-container">
    <h2>Test Recording</h2>
    <p>Hold the microphone button to record. Release to transcribe.</p>

    <ct-voice-input
      id="voiceInput"
      recordingMode="hold"
      autoTranscribe="true"
      maxDuration="60"
      showWaveform="true"
    ></ct-voice-input>

    <div id="transcription-output" class="hidden">
      <h3>Transcription Result:</h3>
      <p id="transcription-text"></p>
      <small id="transcription-meta"></small>
    </div>
  </div>

  <!-- Load the UI library -->
  <script type="module">
    // Import from the built UI package
    import '@commontools/ui/v2';

    const voiceInput = document.getElementById('voiceInput');
    const output = document.getElementById('transcription-output');
    const textEl = document.getElementById('transcription-text');
    const metaEl = document.getElementById('transcription-meta');

    voiceInput.addEventListener('ct-transcription-complete', (event) => {
      console.log('Transcription complete:', event.detail);
      const { transcription } = event.detail;

      output.classList.remove('hidden');
      textEl.textContent = transcription.text;
      metaEl.textContent = `Duration: ${transcription.duration.toFixed(1)}s | Recorded: ${new Date(transcription.timestamp).toLocaleTimeString()}`;
    });

    voiceInput.addEventListener('ct-error', (event) => {
      console.error('Error:', event.detail);
      alert(`Error: ${event.detail.message}`);
    });

    voiceInput.addEventListener('ct-transcription-error', (event) => {
      console.error('Transcription error:', event.detail);
      alert(`Transcription failed: ${event.detail.message}`);
    });

    console.log('Voice input test page ready');
  </script>
</body>
</html>
